---
- name: Get data from user form
  hosts: localhost
  tasks:
    - name: Capture all the form data
      set_stats:
        data:
          business_group: "{{ business_group }}"
          network: "{{ network }}"
          location: "{{ location }}"
          language: "{{ language }}"
          vm_count: "{{ vm_count }}"
          size: "{{ size }}"

    - name: Extract CPU count
      set_fact:
        cpu_count: "{{ size.split('(')[1].split('vCPU')[0] | trim | int  }}"

    - name: Extract memory
      set_fact:
        memory: "{{ size.split(',')[1].split('GB')[0] | trim | int }}"

    - name: Save CPU and memory to stats
      set_stats:
        data:
          cpu_count: "{{ size.split('(')[1].split('vCPU')[0] | trim | int }}"
          memory: "{{ size.split(',')[1].split('GB')[0] | trim | int }}"

